(function(e){function t(t){for(var s,r,i=t[0],l=t[1],u=t[2],d=0,h=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(t);while(h.length)h.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(s=!1)}s&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},a={app:0},o=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/cs3402/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var s=n("64a9"),a=n.n(s);a.a},"175c":function(e,t,n){"use strict";var s=n("436f"),a=n.n(s);a.a},"436f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("6762"),n("2fdb"),n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("Sql Online Judge")]),n("router-view")],1)},o=[],r=(n("034f"),n("2877")),i={},l=Object(r["a"])(i,a,o,!1,null,null,null),u=l.exports,c=n("8c4f"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[s("img",{attrs:{src:n("cf05")}}),s("el-container",[s("el-header",[s("h1",[e._v(e._s(e.msg))])]),s("el-main",[s("el-row",{staticClass:"r",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:3}},[s("el-input",{attrs:{size:"medium",placeholder:"用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:3}},[s("el-input",{attrs:{placeholder:"密码","show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:5}},[s("el-select",{attrs:{placeholder:"请选择用户类型"},model:{value:e.usertype,callback:function(t){e.usertype=t},expression:"usertype"}},e._l(e.usertype_list,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),s("el-row",[s("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)],1)],1)],1)},h=[],m=(n("6b54"),{name:"Home",data:function(){return{username:"",password:"",usertype:"student",usertype_list:[{value:"student",label:"学生"},{value:"admin",label:"管理员"}],msg:"Sql Online Judge"}},methods:{login:function(){var e=this;if(this.username&&this.password&&this.usertype){var t={username:this.username,password:this.password,usertype:this.usertype};this.$store.dispatch("login",t).then((function(){e.$router.push("/"+e.usertype)})).catch((function(t){e.$message.error(t.toString())}))}else this.$message.error("输入为空")}}}),f=m,p=(n("8b71"),Object(r["a"])(f,d,h,!1,null,null,null)),b=p.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"2000px",border:"1px solid #eee"}},[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"default-openeds":["1"]}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-setting"}),e._v("student")]),n("el-menu-item-group",[n("el-menu-item",{key:"Submit",attrs:{index:"1-1"},on:{click:function(t){return e.routerToMain("Submit")}}},[e._v("Exercise")])],1)],2)],1)],1),n("el-container",[n("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[n("Header")],1),n("el-main",[n("router-view")],1)],1)],1)},g=[],_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b",[e._v(e._s(this.$store.getters.Username))]),n("el-link",{attrs:{type:"danger"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[e._v("Logout")])],1)},v=[],$={name:"Header",methods:{logout:function(){var e=this;this.$store.dispatch("logout").then((function(){e.$router.push("/home")}))}}},x=$,k=Object(r["a"])(x,_,v,!1,null,"29afcbc5",null),y=k.exports,S={name:"index",components:{Header:y},methods:{routerToMain:function(e){this.$router.push("/student/"+e)}}},L=S,T=Object(r["a"])(L,w,g,!1,null,"0147f075",null),q=T.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.questionList}},[n("el-table-column",{attrs:{label:"id",prop:"id",width:"180"}}),n("el-table-column",{attrs:{label:"Title",prop:"title",width:"180"}}),n("el-table-column",{attrs:{label:"database",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{trigger:"hover",placement:"top"}},[n("p",[e._v("name: "+e._s(t.row.database.name))]),n("p",[e._v("description: "+e._s(t.row.database.description))]),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.database.name))])],1)])]}}])}),n("el-table-column",{attrs:{label:"Solve"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleSubmit(t.$index,t.row)}}},[e._v("Solve")])]}}])})],1)],1)},F=[],I=n("2909"),A={name:"Submit",data:function(){return{questionList:[],databaseMap:{}}},mounted:function(){this.refresh()},methods:{refresh:function(){var e=this;this.$axios.get("/schema",{headers:{session:this.$store.getters.Token}}).then((function(t){for(var n=t.data["data"],s=0;s<n.length;s++)e.databaseMap[n[s]["id"]]=n[s];e.questionList=[],e.$axios.get("/question",{headers:{session:e.$store.getters.Token}}).then((function(t){var n;(n=e.questionList).push.apply(n,Object(I["a"])(t.data["data"]));for(var s=0;s<e.questionList.length;s++){e.questionList[s]["database"]=e.databaseMap[e.questionList[s]["idSchema"]];var a=e.questionList[s]["max_score"];a["score"]>=0?e.questionList[s]["tag"]=e.questionList[s]["score"]===a["score"]?"success":"danger":e.questionList[s]["tag"]="warning"}})).catch((function(t){e.$message.error(t.toString())}))})).catch((function(t){e.$message.error(t.toString())}))},handleSubmit:function(e,t){this.$router.push({name:"Question",params:{idQuestion:t["id"],row:t}})}}},R=A,O=Object(r["a"])(R,Q,F,!1,null,"19fe7b71",null),M=O.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handle_change_question},model:{value:e.select_question_id,callback:function(t){e.select_question_id=t},expression:"select_question_id"}},e._l(e.questionList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("v-chart",{attrs:{options:e.score_chart,title:"分数分布直方图",autoresize:""}},[e._v("\n                fensh\n            ")]),n("p",[e._v("分数分布图")])],1),n("el-col",{attrs:{span:12}},[n("v-chart",{attrs:{options:e.type_chart,title:"答案类型饼状图",autoresize:""}}),n("p",[e._v("类型分布图")])],1)],1)],1)},D=[],z=(n("ac6a"),{name:"Statistics",data:function(){return{questionList:[],select_question_id:-1,score_chart:{title:{text:"分数分布直方图",x:"center"},xAxis:{type:"category",name:"分数",data:Object(I["a"])(Array(11).keys())},yAxis:{type:"value",name:"频次"},series:[{name:"分数频次",data:[],type:"bar",smooth:!0}],tooltip:{show:!0,trigger:"axis",axisPointer:{type:"shadow"}}},type_chart:{title:{x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",bottom:"bottom",data:[]},series:[{name:"答案类型",type:"pie",data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}},methods:{set_chart_data:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n="";n=null===t||-1===t?"submit":"question/"+t+"/submit",this.$axios.get(n,{headers:{session:this.$store.getters.Token}}).then((function(t){e.score_chart.series[0].data=t.data.chart.score,e.type_chart.legend.data=t.data.chart.type_name,e.type_chart.series[0].data=t.data.chart.type})).catch((function(t){e.$message.error(t.toString())}))},get_questionList:function(){var e=this;this.questionList=[{id:-1,title:"所有"}],this.$axios.get("/question",{headers:{session:this.$store.getters.Token}}).then((function(t){var n;(n=e.questionList).push.apply(n,Object(I["a"])(t.data["data"]))})).catch((function(t){e.$message.error(t.toString())}))},handle_change_question:function(e){this.set_chart_data(e)}},mounted:function(){this.set_chart_data(),this.get_questionList()}}),N=z,E=Object(r["a"])(N,j,D,!1,null,"68a76bc0",null),C=E.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-container",{staticStyle:{height:"900px",border:"1px solid #eee"}},[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"default-openeds":["1"]}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-setting"}),e._v("admin")]),n("el-menu-item-group",[n("el-menu-item",{key:"studentManage",attrs:{index:"1-1"},on:{click:function(t){return e.routerToMain("StudentManage")}}},[e._v("学生管理")]),n("el-menu-item",{attrs:{index:"1-2"},on:{click:function(t){return e.routerToMain("DatabaseManage")}}},[e._v("数据库管理")]),n("el-menu-item",{attrs:{index:"1-3"},on:{click:function(t){return e.routerToMain("QuestionManage")}}},[e._v("问题管理")])],1)],2)],1)],1),n("el-container",[n("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[n("Header")],1),n("el-main",[n("router-view")],1)],1)],1)],1)},P=[],H={name:"index",components:{Header:y},data:function(){return{}},methods:{routerToMain:function(e){this.$router.push("/admin/"+e)}}},J=H,K=(n("175c"),Object(r["a"])(J,U,P,!1,null,"51b7c413",null)),Y=K.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"id"},model:{value:e.new_id,callback:function(t){e.new_id=t},expression:"new_id"}})],1),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"姓名"},model:{value:e.new_name,callback:function(t){e.new_name=t},expression:"new_name"}})],1),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"密码"},model:{value:e.new_password,callback:function(t){e.new_password=t},expression:"new_password"}})],1),n("el-col",{attrs:{span:4}},[n("el-button",{on:{click:e.addStudent}},[e._v("add")])],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.studentList}},[n("el-table-column",{attrs:{label:"id",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!0,size:"mini"},model:{value:t.row.id,callback:function(n){e.$set(t.row,"id",n)},expression:"scope.row.id"}})]}}])}),n("el-table-column",{attrs:{label:"姓名",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!t.row.edit,size:"mini"},model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}})]}}])}),n("el-table-column",{attrs:{label:"密码",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!t.row.edit,size:"mini"},model:{value:t.row.password,callback:function(n){e.$set(t.row,"password",n)},expression:"scope.row.password"}})]}}])}),n("el-table-column",{attrs:{label:"opt",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v(e._s(t.row.edit?"提交":"编辑"))]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)},V=[],X=(n("7f7f"),{name:"StudentManage",data:function(){return{studentList:[],new_id:"",new_name:"",new_password:""}},mounted:function(){this.refresh()},methods:{addStudent:function(){var e=this;""===this.new_password||""===this.new_name||""===this.new_id?this.$message.error("输入错误"):this.$axios.post("/student",{session:this.$store.getters.Token,id:this.new_id,name:this.new_name,password:this.new_password}).then((function(t){e.$message.info("成功"),e.new_password="",e.new_id="",e.new_name="",e.refresh()})).catch((function(t){e.$message.error(t.toString())}))},addEdit:function(){for(var e=0;e<this.studentList.length;e++)this.studentList[e]["edit"]=!1},handleEdit:function(e,t){var n=this;t.edit?this.$axios.patch("/student/"+t.id,{session:this.$store.getters.Token,name:t.name,password:t.password}).then((function(s){n.$message.info("成功"),t.edit=!1,n.$set(n.studentList,e,t)})).catch((function(e){n.$message.error(e.toString())})):(t.edit=!0,this.$set(this.studentList,e,t))},handleDelete:function(e,t){var n=this;this.$axios.delete("/student/"+t.id,{data:{session:this.$store.getters.Token}}).then((function(e){n.$message.info("删除成功"),n.refresh()})).catch((function(e){n.$message.error(e.toString())}))},refresh:function(){var e=this;this.studentList=[],this.$axios.get("/student",{headers:{session:this.$store.getters.Token}}).then((function(t){var n;(n=e.studentList).push.apply(n,Object(I["a"])(t.data["data"])),e.addEdit()})).catch((function(t){e.$message.error(t.toString())}))}}}),G=X,W=Object(r["a"])(G,B,V,!1,null,"1896a689",null),Z=W.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("h1",[e._v(e._s(e.idQuestion+" "+e.questionInfo.title))])]),n("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{attrs:{title:"Question Description",name:"1"}},[n("el-row",[n("el-input",{attrs:{type:"textarea",readonly:""},model:{value:e.questionInfo.text,callback:function(t){e.$set(e.questionInfo,"text",t)},expression:"questionInfo.text"}})],1)],1)],1),n("h3",[e._v("Your Answer?")]),n("el-input",{attrs:{type:"textarea"},model:{value:e.answer,callback:function(t){e.answer=t},expression:"answer"}}),n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n            Submit\n        ")]),e.showResult?n("div",{attrs:{align:"left",id:"result"}},[n("h2",[e._v("Result:")]),n("p",[e._v("Error: "),n("span",{staticStyle:{color:"red"}},[e._v(e._s(e.result["syntax_error_msg"]))])]),n("el-table",{attrs:{data:e.result["compare_result"]}},[n("el-table-column",{attrs:{label:"Your Result",prop:"your_result"}}),n("el-table-column",{attrs:{label:"Correct Result",prop:"right_result"}})],1)],1):e._e()],1)},te=[],ne=(n("a481"),n("c5f6"),n("28a5"),{name:"Question",data:function(){return{idQuestion:this.$route.params.idQuestion,questionInfo:this.$route.params.row,answer:"",activeNames:["1","2","3"],showResult:!1,result:{},tableNameList:[],tableInfo:{},colorMap:{0:"#FFFFFF",1:"#FF4500",2:"#008000"}}},mounted:function(){this.getTables(this.questionInfo.idSchema)},methods:{handleSubmit:function(){var e=this;""!==this.answer?this.$axios.post("/question/"+this.idQuestion+"/submit",{session:this.$store.getters.Token,answer:this.answer}).then((function(t){e.result=t.data,e.result["syntax_error_msg"]=e.result["info"].slice(e.result["info"].indexOf("\n")+1);var n=e.result["info"].slice(0,e.result["info"].indexOf("\n")).split(" ").map((function(e){return Number(e)}));e.result["errorInfo"]=e.parseErroInfo2HTML(e.result["your_answer"],n),e.showResult=!0,e.result["tag"]=e.result["score"]===e.questionInfo["score"]?"success":"danger"})).catch((function(t){e.$message.error(t.toString())})):this.$message.error("answer不能为空")},parseErroInfo2HTML:function(e,t){if(e.length!==t.length)return this.$message.error("length not match"),"";String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,n){return"undefined"!=typeof e[n]?e[n]:t}))});for(var n=0,s='<font color="{0}">',a=s+e[0],o=1;o<e.length;o++)t[o-1].toString()!==t[o].toString()&&(a=a.format(this.getColor(t[o-1]))+"</font>"+s,n=o),a+=e[o];return a=a.format(this.getColor(t[n]))+"</font>",a},getColor:function(e){return e=Number(e),0===e?"#000000":0<e&&e<1?"#FF0000":1===e?"#008000":"#FFFFFFFF"},getTables:function(e){var t=this;this.$axios.get("/schema/"+e+"/table",{headers:{session:this.$store.getters.Token}}).then((function(e){t.tableNameList=[];for(var n=0;n<e.data["table_name"].length;n++)t.tableNameList.push({name:e.data["table_name"][n],info:e.data["table"][e.data["table_name"][n]]});t.tableInfo=e.data["table"]})).catch((function(e){t.$message.error(e.toString())}))},tableSegmentRowClassName:function(e){var t=e.row;e.rowIndex;return 0===t.deduction?{background:"greenyellow"}:""===t.right_segment?{background:"oldlace"}:{background:"red"}}}}),se=ne,ae=(n("d67d"),Object(r["a"])(se,ee,te,!1,null,"28216032",null)),oe=ae.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"名字"},model:{value:e.new_name,callback:function(t){e.new_name=t},expression:"new_name"}})],1),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"描述"},model:{value:e.new_description,callback:function(t){e.new_description=t},expression:"new_description"}})],1),n("el-col",{attrs:{span:4}},[n("el-button",{on:{click:e.addDatabase}},[e._v("add database")])],1)],1),n("el-table",{attrs:{data:e.databaseList}},[n("el-table-column",{attrs:{label:"id",prop:"id"}}),n("el-table-column",{attrs:{label:"name",prop:"name"}}),n("el-table-column",{attrs:{label:"description",prop:"description"}}),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleTable(t.$index,t.row)}}},[e._v("管理")])]}}])}),n("el-table-column",{attrs:{label:"keywords",prop:"keywords"}})],1)],1)},ie=[],le={name:"DatabaseManage",data:function(){return{databaseList:[],new_name:"",new_description:""}},mounted:function(){this.getDatabaseList()},methods:{getDatabaseList:function(){var e=this;this.databaseList=[],this.$axios.get("/schema",{headers:{session:this.$store.getters.Token}}).then((function(t){e.databaseList=t.data["data"]})).catch((function(t){e.$message.error(t.toString())}))},handleTable:function(e,t){this.$router.push({name:"TableManage",params:{idSchema:t["id"],row:t}})},addDatabase:function(){var e=this;""===this.new_name?this.$message.error("name 不能为空"):this.$axios.post("/schema",{session:this.$store.getters.Token,name:this.new_name,description:this.new_description}).then((function(t){e.$message.info("加入成功"),e.new_name="",e.new_description="",e.getDatabaseList()})).catch((function(t){e.$message.error(t.toString())}))}}},ue=le,ce=Object(r["a"])(ue,re,ie,!1,null,"c98d0264",null),de=ce.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h2",[e._v("问题管理")]),n("el-table",{attrs:{data:e.questionList}},[n("el-table-column",{attrs:{label:"id",prop:"id"}}),n("el-table-column",{attrs:{label:"title",prop:"title"}}),n("el-table-column",{attrs:{label:"score",prop:"score"}}),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleAnswer(t.$index,t.row)}}},[e._v("Answer")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleStatistics(t.$index,t.row)}}},[e._v("Statistics")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleDeleteQuestion(t.$index,t.row)}}},[e._v("Delete")])]}}])})],1),n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showQuestionForm,expression:"showQuestionForm"}],ref:"newQuestionForm",attrs:{model:e.newQuestionForm,"label-position":"left"}},[n("el-form-item",{attrs:{label:"title"}},[n("el-input",{model:{value:e.newQuestionForm.title,callback:function(t){e.$set(e.newQuestionForm,"title",t)},expression:"newQuestionForm.title"}})],1),n("el-form-item",{attrs:{label:"text"}},[n("el-input",{model:{value:e.newQuestionForm.text,callback:function(t){e.$set(e.newQuestionForm,"text",t)},expression:"newQuestionForm.text"}})],1),n("el-form-item",{attrs:{label:"score"}},[n("el-input",{model:{value:e.newQuestionForm.score,callback:function(t){e.$set(e.newQuestionForm,"score",t)},expression:"newQuestionForm.score"}})],1),n("el-form-item",{attrs:{label:"database"}},[n("el-select",{attrs:{placeholder:"请选择一个数据库"},model:{value:e.newQuestionForm.idSchema,callback:function(t){e.$set(e.newQuestionForm,"idSchema",t)},expression:"newQuestionForm.idSchema"}},e._l(e.databaseOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.addQuestion}},[e._v("提交")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showStats,expression:"showStats"}]},[n("h2",[e._v("Statistics of "+e._s(e.currentQuestionTitle))]),n("h4",[e._v("Correct Rate:"+e._s(e.currentQuestionCorrectRate))]),n("el-table",{attrs:{data:e.stats}},[n("el-table-column",{attrs:{label:"Submit ID",prop:"submit_id"}}),n("el-table-column",{attrs:{label:"SID",prop:"sid"}}),n("el-table-column",{attrs:{label:"Name",prop:"sname"}}),n("el-table-column",{attrs:{label:"Correctness",prop:"correctness"}}),n("el-table-column",{attrs:{label:"Answer"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleCheckResult(t.$index,t.row)}}},[e._v("Check")])]}}])})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showResult,expression:"showResult"}]},[n("h4",[e._v("Student Answer:")]),n("p",[e._v(e._s(e.studentAnswer))]),n("h4",[e._v("Correct Answer:")]),n("p",[e._v(e._s(e.correctAnswer))]),n("h4",[e._v("Student Result:")]),n("p",[e._v(e._s(e.studentResult))])])],1)},me=[],fe={name:"QuestionManage",data:function(){return{questionList:[],stats:[],newQuestionForm:{idSchema:"",title:"",text:"",score:""},databaseList:[],databaseOptions:[],showQuestionForm:!0,showStats:!1,showResult:!1,currentQuestionId:-1,currentQuestionTitle:"",currentQuestionCorrectRate:"0",currentSubmitId:-1,studentAnswer:"",correctAnswer:"",studentResult:""}},mounted:function(){this.getQuestionList()},methods:{addQuestion:function(){var e=this;this.newQuestionForm["session"]=this.$store.getters.Token,this.$axios.post("/question",this.newQuestionForm).then((function(t){e.$message.success("成功"),e.getQuestionList(),e.newQuestionForm.idSchema="",e.newQuestionForm.score="",e.newQuestionForm.text="",e.newQuestionForm.title=""})).catch((function(t){e.$message.error(t.toString())}))},getQuestionList:function(){var e=this;this.getDatabaseList(),this.questionList=[],this.$axios.get("/question",{headers:{session:this.$store.getters.Token}}).then((function(t){e.questionList=t.data["data"]})).catch((function(t){e.$message.error(t.toString())}))},handleAnswer:function(e,t){this.$router.push({name:"AnswerManage",params:{idQuestion:t["id"],row:t}})},handleDeleteQuestion:function(e,t){var n=this;this.$axios.delete("/question/"+t.id,{data:{session:this.$store.getters.Token}}).then((function(e){n.$message.success("done"),n.getQuestionList()})).catch((function(e){n.$message.error(e.toString())}))},handleStatistics:function(e,t){var n=this;if(!0===this.showStats&&this.currentQuestionId===t.id)return this.showStats=!1,this.showQuestionForm=!0,void(this.currentQuestionId=-1);this.showQuestionForm=!1,this.showStats=!0,this.currentQuestionId=t.id,this.currentQuestionTitle=t.title,this.$axios.get("/question/"+this.currentQuestionId+"/correct_rate",{headers:{session:this.$store.getters.Token}}).then((function(e){n.currentQuestionCorrectRate=(100*e.data["rate"]).toFixed(1)+"%"})).catch((function(e){n.$message.error(e.toString())})),this.$axios.get("/question/"+this.currentQuestionId+"/stats",{headers:{session:this.$store.getters.Token}}).then((function(e){n.stats=e.data["data"]}))},handleCheckResult:function(e,t){var n=this;if(!0===this.showResult&&this.currentSubmitId===t.submit_id)return this.showResult=!1,void(this.currentSubmitId=-1);this.$axios.get("/check_result/"+t.submit_id,{headers:{session:this.$store.getters.Token}}).then((function(e){n.studentAnswer=e.data["answer"],n.correctAnswer=e.data["correct"],n.studentResult=e.data["result"]})),this.currentSubmitId=t.submit_id,this.showResult=!0},getDatabaseList:function(){var e=this;this.databaseList=[],this.databaseOptions=[],this.$axios.get("/schema",{headers:{session:this.$store.getters.Token}}).then((function(t){e.databaseList=t.data["data"];for(var n=0;n<e.databaseList.length;n++)e.databaseOptions.push({value:e.databaseList[n]["id"],label:e.databaseList[n]["name"]})})).catch((function(t){e.$message.error(t.toString())}))}}},pe=fe,be=Object(r["a"])(pe,he,me,!1,null,"0cad0f6c",null),we=be.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{attrs:{data:e.tableList,"expand-row-keys":e.expand_key,"row-key":e.getRowKeys}},[n("el-table-column",{attrs:{type:"expand",hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{directives:[{name:"show",rawName:"v-show",value:"table"===t.row.current_info,expression:"props.row.current_info==='table'"}]},[n("b",[e._v("Table Detail:")]),n("el-table",{attrs:{data:e.tableInfo[t.row.name].cols}},[n("el-table-column",{attrs:{label:"Number",prop:"[0]"}}),n("el-table-column",{attrs:{label:"Column Name",prop:"[1]"}}),n("el-table-column",{attrs:{label:"Column Type",prop:"[2]"}}),n("el-table-column",{attrs:{label:"Not Null",prop:"[3]"}}),n("el-table-column",{attrs:{label:"Default Value",prop:"[4]"}}),n("el-table-column",{attrs:{label:"PK",prop:"[5]"}})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"showRows"===t.row.current_info,expression:"props.row.current_info==='showRows'"}]},[n("b",[e._v("Rows info:")]),n("el-table",{attrs:{data:e.rows["detail"]}},[e._l(e.tableInfo[t.row.name].cols,(function(t){return n("el-table-column",{key:t[0],attrs:{label:t[1]},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                                "+e._s(n.row[t[0]])+"\n                            ")]}}],null,!0)})})),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleDeleteRow(t.$index,t.row)}}},[e._v("删除")])]}}],null,!0)})],2),n("el-table",{attrs:{data:[0]}},[e._l(e.tableInfo[t.row.name].cols,(function(s){return n("el-table-column",{key:s[0],attrs:{label:s[1]}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.tableInfo[t.row.name].new_rows[s[0]],expression:"tableInfo[props.row.name].new_rows[row_name[0]]"}],domProps:{value:e.tableInfo[t.row.name].new_rows[s[0]]},on:{input:function(n){n.target.composing||e.$set(e.tableInfo[t.row.name].new_rows,s[0],n.target.value)}}})])})),n("el-table-column",[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleAddRow(t.$index,t.row)}}},[e._v("add")])],1)],2)],1)]}}])}),n("el-table-column",{attrs:{label:"id",prop:"id"}}),n("el-table-column",{attrs:{label:"name",prop:"name"}}),n("el-table-column",{attrs:{label:"description",prop:"description"}}),n("el-table-column",{attrs:{label:"sql",prop:"sql"}}),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleTableDelete(t.$index,t.row)}}},[e._v("删除")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleShowRows(t.$index,t.row)}}},[e._v("Rows")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleTableInfo(t.$index,t.row)}}},[e._v("tableInfo")])]}}])})],1),n("el-form",{ref:"table_from",attrs:{model:e.table_from}},[n("el-form-item",{attrs:{label:"create sql code"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.table_from.new_table_sql,callback:function(t){e.$set(e.table_from,"new_table_sql",t)},expression:"table_from.new_table_sql"}})],1),n("el-form-item",{attrs:{label:"description"}},[n("el-input",{model:{value:e.table_from.new_description,callback:function(t){e.$set(e.table_from,"new_description",t)},expression:"table_from.new_description"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.hanldeNewTable}},[e._v("Add")])],1)],1)],1)},_e=[],ve=(n("6c7b"),{name:"TableManage",data:function(){return{idSchema:this.$route.params.idSchema,schemaInfo:this.$route.params.row,tableList:[],tableNameList:[],tableInfo:{},current_info:"table",rows:{},expand_key:[],new_rows:[],table_from:{new_table_sql:"",new_description:""}}},mounted:function(){this.getTableList()},methods:{getTableList:function(){var e=this;this.$axios.get("schema/"+this.idSchema+"/table",{headers:{session:this.$store.getters.Token}}).then((function(t){e.tableList=t.data["data"];for(var n=0;n<e.tableList.length;n++)e.tableList[n]["current_info"]="table";for(var s in e.tableNameList=t.data["table_name"],e.tableInfo=t.data["table"],e.tableInfo)e.tableInfo[s]["new_rows"]=Array(e.tableInfo[s]["cols"].length).fill("")})).catch((function(t){e.$message.error(t.toString())}))},handleTableDelete:function(e,t){var n=this;this.$axios.delete("schema/"+this.idSchema+"/table/"+t.id,{data:{session:this.$store.getters.Token}}).then((function(e){n.$message.success("success"),n.getTableList()})).catch((function(e){n.$message.error(e.toString())}))},handleDeleteRow:function(e,t){var n=this;this.$axios.delete("/table/"+this.rows.data[e].idTable+"/rows/"+this.rows.data[e].id,{data:{session:this.$store.getters.Token}}).then((function(t){n.$message.success("成功"),n.$axios.get("table/"+n.rows.data[e].idTable+"/rows",{headers:{session:n.$store.getters.Token}}).then((function(e){n.rows=e.data})).catch((function(e){n.$message.error(e.toString())}))})).catch((function(e){n.$message.error(e.response.data[0]["msg"])}))},handleShowRows:function(e,t){var n=this;this.$axios.get("table/"+t.id+"/rows",{headers:{session:this.$store.getters.Token}}).then((function(s){n.rows=s.data,t.current_info="showRows",n.$set(n.tableList,e,t),n.expand_key=[],n.expand_key.push(t.id)})).catch((function(e){n.$message.error(e.toString())}))},getRowKeys:function(e){return e.id},handleTableInfo:function(e,t){t.current_info="table",this.$set(this.tableList,e,t),this.expand_key=[],this.expand_key.push(t.id)},handleAddRow:function(e,t){var n=this;this.$axios.post("/table/"+t.id+"/rows",{session:this.$store.getters.Token,data:this.tableInfo[t.name]["new_rows"]}).then((function(s){n.$message.success("成功"),n.handleShowRows(e,t),n.tableInfo[t.name]["new_rows"]=Array(n.tableInfo[t.name]["new_rows"].length).fill("")})).catch((function(e){n.$message.error(e.response.data[0]["msg"])}))},hanldeNewTable:function(){var e=this;this.$axios.post("/schema/"+this.idSchema+"/table",{session:this.$store.getters.Token,sql:this.table_from.new_table_sql,description:this.table_from.new_description}).then((function(t){e.$message.success("成功"),e.getTableList(),e.table_from.new_table_sql="",e.table_from.new_description=""})).catch((function(t){e.$message.error(t.response.data[0]["msg"])}))}}}),$e=ve,xe=Object(r["a"])($e,ge,_e,!1,null,"3c862b58",null),ke=xe.exports,ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h2",[e._v("答案管理")]),n("el-table",{attrs:{data:e.answerList}},[n("el-table-column",{attrs:{label:"id",prop:"id"}}),n("el-table-column",{attrs:{label:"sql",prop:"sql"}}),n("el-table-column",{attrs:{label:"json",prop:"json"}}),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleDeleteAnswer(t.$index,t.row)}}},[e._v("Delete")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleSegment(t.$index,t.row)}}},[e._v("Segment")])]}}])})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showSegment,expression:"showSegment"}]},[n("h3",[e._v("Answer ID:"+e._s(e.currentShowAnswerId))]),n("el-table",{attrs:{data:e.segments}},[n("el-table-column",{attrs:{label:"id",prop:"id"}}),n("el-table-column",{attrs:{label:"子句",prop:"data"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!t.row.edit,size:"mini"},model:{value:t.row.data,callback:function(n){e.$set(t.row,"data",n)},expression:"scope.row.data"}})]}}])}),n("el-table-column",{attrs:{label:"score",prop:"score"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!t.row.edit,size:"mini"},model:{value:t.row.score,callback:function(n){e.$set(t.row,"score",n)},expression:"scope.row.score"}})]}}])}),n("el-table-column",{attrs:{label:"extra",prop:"extra"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{disabled:!t.row.edit,size:"mini"},model:{value:t.row.extra,callback:function(n){e.$set(t.row,"extra",n)},expression:"scope.row.extra"}})]}}])}),n("el-table-column",{attrs:{label:"opt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.handleEditSegment(t.$index,t.row)}}},[e._v("\n            "+e._s(t.row.edit?"提交":"编辑")+"\n          ")])]}}])})],1)],1),n("el-form",{ref:"newAnswerForm",attrs:{model:e.newAnswerForm}},[n("el-form-item",{attrs:{label:"sql"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.newAnswerForm.sql,callback:function(t){e.$set(e.newAnswerForm,"sql",t)},expression:"newAnswerForm.sql"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.addAnswer}},[e._v("Add")])],1)],1)],1)},Se=[],Le={name:"AnswerManage",data:function(){return{idQuestion:this.$route.params.idQuestion,questionInfo:this.$route.params.row,answerList:[],newAnswerForm:{sql:""},showSegment:!1,currentShowAnswerId:-1,segments:[]}},mounted:function(){this.getAnswerList()},methods:{getAnswerList:function(){var e=this;this.$axios.get("/question/"+this.idQuestion+"/answer",{headers:{session:this.$store.getters.Token}}).then((function(t){e.answerList=[],e.answerList=t.data["data"]})).catch((function(t){e.$message.error(t.toString())}))},addAnswer:function(){var e=this;this.newAnswerForm["session"]=this.$store.getters.Token,this.$axios.post("/question/"+this.idQuestion+"/answer",this.newAnswerForm).then((function(t){e.$message.success("成功"),e.getAnswerList(),e.newAnswerForm["session"]="",e.newAnswerForm["sql"]=""})).catch((function(t){e.$message.error(t.response.data["msg"])}))},handleDeleteAnswer:function(e,t){var n=this;this.$axios.delete("/question/"+this.idQuestion+"/answer/"+t.id,{data:{session:this.$store.getters.Token}}).then((function(e){n.$message.success(e.data),n.getAnswerList()})).catch((function(e){n.$message.error(e.toString())}))},handleSegment:function(e,t){var n=this;if(this.currentShowAnswerId===t.id&&!0===this.showSegment)return this.showSegment=!1,void(this.currentShowAnswerId=-1);this.$axios.get("/answer/"+t.id+"/segment",{headers:{session:this.$store.getters.Token}}).then((function(e){n.segments=e.data["data"];for(var s=0;s<n.segments.length;s++)n.segments[s]["edit"]=!1;n.showSegment=!0,n.currentShowAnswerId=t.id})).catch((function(e){n.$message.error(e.toString())}))},handleEditSegment:function(e,t){var n=this;console.log(t),t.edit?this.$axios.patch("/answer/"+t.id+"/segment/"+t.id,{session:this.$store.getters.Token,data:t.data,extra:t.extra,score:t.score}).then((function(s){t.edit=!1,n.$message.success("done"),n.$set(n.segments,e,t)})).catch((function(e){n.$message.error(e.toString())})):(t.edit=!0,console.log(e),this.$set(this.segments,e,t))}}},Te=Le,qe=Object(r["a"])(Te,ye,Se,!1,null,"822d2926",null),Qe=qe.exports;s["default"].use(c["a"]);var Fe=new c["a"]({routes:[{path:"/home",name:"home",component:b},{path:"/admin",name:"admin/index",component:Y,children:[{path:"StudentManage",component:Z},{path:"DatabaseManage",component:de},{path:"QuestionManage",component:we},{path:"TableManage",component:ke,name:"TableManage"},{path:"AnswerManage",component:Qe,name:"AnswerManage"}]},{path:"/student",name:"student/index",component:q,children:[{path:"Submit",component:M},{path:"Statistics",component:C},{path:"Question",component:oe,name:"Question"}]}]}),Ie=n("2f62"),Ae=n("bc3a"),Re=n.n(Ae);s["default"].use(Ie["a"]);var Oe=new Ie["a"].Store({state:{usertype:"",token:"",username:""},getters:{Usertype:function(e){return e.usertype},Token:function(e){return e.token},Username:function(e){return e.username}},mutations:{setUsertype:function(e,t){["","student","admin"].includes(t)&&(e.usertype=t)},setToken:function(e,t){e.token=t},setUsername:function(e,t){e.username=t}},actions:{login:function(e,t){return new Promise((function(n,s){return Re.a.post("/session/"+t["usertype"],t).then((function(s){e.commit("setToken",s.data["session"]),e.commit("setUsertype",t["usertype"]),e.commit("setUsername",s.data["name"]),n()})).catch((function(e){s(e)}))}))},logout:function(e){e.commit("setUsertype",""),e.commit("setToken","")}}}),Me=n("a7fe"),je=n.n(Me),De=n("5c96"),ze=n.n(De),Ne=(n("0fae"),n("9ca8"));n("ef97"),n("94b1"),n("c037");s["default"].component("v-chart",Ne["a"]),s["default"].config.productionTip=!1,s["default"].prototype.$axios=Re.a,Re.a.defaults.baseURL="http://127.0.0.1:5000",s["default"].use(je.a,Re.a),s["default"].use(ze.a),Fe.beforeEach((function(e,t,n){"admin"!==Oe.getters.Usertype||e.path.includes("admin")?"student"!==Oe.getters.Usertype||e.path.includes("student")?e.path.includes("home")||""!==Oe.getters.Usertype?n():n("/home"):n("/student"):n("/admin")})),new s["default"]({router:Fe,store:Oe,render:function(e){return e(u)}}).$mount("#app")},"64a9":function(e,t,n){},"8b71":function(e,t,n){"use strict";var s=n("e3a2"),a=n.n(s);a.a},"95fc":function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"},d67d:function(e,t,n){"use strict";var s=n("95fc"),a=n.n(s);a.a},e3a2:function(e,t,n){}});
//# sourceMappingURL=app.48539cb9.js.map